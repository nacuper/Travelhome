daemon off;

events {
  worker_connections  4096;  ## Default: 1024
}

http {
	include    mime.types;

	upstream us_travelclub {
		server www.travelclub.cl;
	}

	upstream us_grayshirts {
		server www.grayshirts.com.ar;
	}

	server {
		listen <%= ENV['PORT'] %> default_server;
		listen [::]:<%= ENV['PORT'] %> default_server ipv6only=on;
		server_name travelclub-nginx.herokuapp.com;
		
		location /gs {
			rewrite /gs(.*) /$1  break;
			proxy_set_header Host www.grayshirts.com.ar;
			proxy_pass http://us_grayshirts; 
		}

		location /producto {
			rewrite /(.*) /tienda/$1  break;
			proxy_set_header Host www.travelclub.cl;
			proxy_pass http://us_travelclub; 
		}


		location /* {
			proxy_set_header Host www.travelclub.cl;
			proxy_pass http://us_travelclub; 
		}

		location / {
			rewrite ^/$ /tienda/  break;
			proxy_set_header Host www.travelclub.cl;
			proxy_pass http://us_travelclub; 
		}
	}
}